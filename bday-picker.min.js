/*
 * jQuery Birthday Picker: v1.4 - 10/16/2011
 * http://abecoffman.com/stuff/birthdaypicker
 *
 * Copyright (c) 2010 Abe Coffman
 * Dual licensed under the MIT and GPL licenses.
 *
 */
!function(e){{var a={"short":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"long":["January","February","March","April","May","June","July","August","September","October","November","December"]},t=new Date,n=t.getFullYear();t.getMonth()+1,t.getDate()}e.fn.birthdaypicker=function(t){var r={maxAge:120,minAge:0,futureDates:!1,maxYear:n,dateFormat:"middleEndian",monthFormat:"short",placeholder:!0,legend:"",defaultDate:!1,fieldName:"birthdate",fieldId:"birthdate",hiddenDate:!0,onChange:null,tabindex:null};return this.each(function(){t&&e.extend(r,t);var l=e("<fieldset class='birthday-picker'></fieldset>"),d=e("<select class='birth-year' name='birth[year]'></select>"),i=e("<select class='birth-month' name='birth[month]'></select>"),o=e("<select class='birth-day' name='birth[day]'></select>");r.legend&&e("<legend>"+r.legend+"</legend>").appendTo(l);var p=r.tabindex;"bigEndian"==r.dateFormat?(l.append(d).append(i).append(o),null!=p&&(d.attr("tabindex",p),i.attr("tabindex",p++),o.attr("tabindex",p++))):"littleEndian"==r.dateFormat?(l.append(o).append(i).append(d),null!=p&&(o.attr("tabindex",p),i.attr("tabindex",p++),d.attr("tabindex",p++))):(l.append(i).append(o).append(d),null!=p&&(i.attr("tabindex",p),o.attr("tabindex",p++),d.attr("tabindex",p++))),r.placeholder&&(e("<option value='0'>Year:</option>").appendTo(d),e("<option value='0'>Month:</option>").appendTo(i),e("<option value='0'>Day:</option>").appendTo(o));var u;if(r.defaultDate){var h=new Date(r.defaultDate+"T00:00:00"),s=h.getFullYear(),f=h.getMonth()+1,v=h.getDate();10>f&&(f="0"+f),10>v&&(v="0"+v),u=s+"-"+f+"-"+v}r.hiddenDate&&e("<input type='hidden' name='"+r.fieldName+"'/>").attr("id",r.fieldId).val(u).appendTo(l);var c=n-r.minAge,m=n-r.maxAge;r.futureDates&&r.maxYear!=n&&(c=r.maxYear>1e3?r.maxYear:n+r.maxYear);for(var g=c;g>=m;g--)e("<option></option>").attr("value",g).text(g).appendTo(d);for(var b=0;12>b;b++)e("<option></option>").attr("value",b+1).text(a[r.monthFormat][b]).appendTo(i);for(var D=1;32>D;D++)e("<option></option>").attr("value",D).text(D).appendTo(o);if(e(this).append(l),r.defaultDate){var x=new Date(r.defaultDate+"T00:00:00");d.val(x.getFullYear()),i.val(x.getMonth()+1),o.val(x.getDate())}l.change(function(){var t=new Date,n=(t.getFullYear(),t.getMonth()+1),l=t.getDate(),p=parseInt(d.val(),10),h=parseInt(i.val(),10),s=parseInt(o.val(),10),f=new Date(p,h,0).getDate(),v=parseInt(i.children(":last").val()),m=parseInt(o.children(":last").val());if(m>f)for(;m>f;)o.children(":last").remove(),m--;else if(f>m)for(;f>m;)m++,o.append("<option value="+m+">"+m+"</option>");if(!r.futureDates&&p==c){if(v>n){for(;v>n;)i.children(":last").remove(),v--;o.children(":first").attr("selected","selected")}if(h===n)for(;m>l;)o.children(":last").remove(),m-=1}if(p!=c&&12!=v)for(;12>v;)i.append("<option value="+(v+1)+">"+a[r.monthFormat][v]+"</option>"),v++;p*h*s!=0?(10>h&&(h="0"+h),10>s&&(s="0"+s),u=p+"-"+h+"-"+s):u=null,e(this).find("#"+r.fieldId).val(u),null!=r.onChange&&r.onChange(u)})})}}(jQuery);